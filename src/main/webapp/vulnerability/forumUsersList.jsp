<%@page import="java.sql.ResultSet"%>
<%@page import="java.sql.PreparedStatement"%>
<%@page import="java.sql.Connection"%>
<%@ include file="/header.jsp" %>
<%@ page import="org.cysecurity.cspf.jvl.model.DBConnect"%>
<%
    String username = request.getParameter("username");

    // Використання try-with-resources для автоматичного закриття ресурсів
    try (Connection con = new DBConnect().connect(getServletContext().getRealPath("/WEB-INF/config.properties"));
         PreparedStatement stmt = con.prepareStatement("SELECT * FROM users");
         ResultSet rs = stmt.executeQuery()) {

        out.print("Users: ");
        out.print("<ol>");
        while (rs.next()) {
            out.print("<li>");
            out.print("<a href='UserDetails.jsp?username=" + rs.getString("username") + "'>" + rs.getString("username") + "</a>");
            out.print("</li>");
        }
        out.print("</ol>");

    } catch (SQLException e) {
        e.printStackTrace();
    }

    out.print("<br/><br/><a href='forum.jsp'>Return to Forum &gt;&gt;</a>");
%>
<%@ include file="/footer.jsp" %>